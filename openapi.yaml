swagger: '2.0'
info:
  title: Star Wars Insights API
  description: Interface inteligente para exploração do universo Star Wars via NLP e filtros estruturados com suporte total a CORS.
  version: 1.1.0
schemes:
  - https
produces:
  - application/json

# Definição de Backend Padrão (Fallback)
x-google-backend:
  address: "https://us-east1-pod-ps-backend-python.cloudfunctions.net/star_wars_insights"
  path_translation: APPEND_PATH_TO_ADDRESS

paths:
  /:
    get:
      summary: Busca principal (NLP ou Estruturada)
      operationId: handleRequest
      parameters:
        - name: q
          in: query
          type: string
        - name: name
          in: query
          type: string
        - name: type
          in: query
          type: string
        - name: filter
          in: query
          type: string
      responses:
        200:
          description: Sucesso
    options:
      summary: CORS Root
      operationId: corsRoot
      responses: &corsResponse
        200:
          description: OK
          headers:
            Access-Control-Allow-Origin:
              type: string
            Access-Control-Allow-Methods:
              type: string
            Access-Control-Allow-Headers:
              type: string

  /login:
    get:
      summary: Inicia fluxo OAuth2
      operationId: handleLogin
      responses:
        302:
          description: Redirecionamento

  /callback:
    get:
      summary: Processa código do Google
      operationId: handleCallback
      responses:
        200:
          description: Sucesso

  /me:
    get:
      summary: Perfil do Usuário
      operationId: getUserProfile
      x-google-backend:
        address: "https://us-east1-pod-ps-backend-python.cloudfunctions.net/star_wars_insights/me"
      responses:
        200:
          description: Sucesso
    options:
      summary: CORS Me
      operationId: corsMe
      x-google-backend:
        address: "https://us-east1-pod-ps-backend-python.cloudfunctions.net/star_wars_insights/me"
      responses:
        200:
          description: OK
          headers:
            Access-Control-Allow-Origin:
              type: string
            Access-Control-Allow-Methods:
              type: string
            Access-Control-Allow-Headers:
              type: string

  /history:
      get:
        operationId: getHistory
        x-google-backend:
          address: "https://us-east1-pod-ps-backend-python.cloudfunctions.net/star_wars_insights/history"
        responses:
          200: {description: Sucesso}
      options:
        operationId: corsHistory
        x-google-backend:
          address: "https://us-east1-pod-ps-backend-python.cloudfunctions.net/star_wars_insights/history"
        responses:
          200:
            description: OK
            headers:
              Access-Control-Allow-Origin:
                type: string
              Access-Control-Allow-Methods:
                type: string
              Access-Control-Allow-Headers:
                type: string


  /metadata:
    get:
      summary: Entidades e intenções mapeadas
      operationId: getMetadata
      responses:
        200:
          description: Sucesso
    options:
      summary: CORS Metadata
      operationId: corsMetadata
      responses:
        200:
          description: OK
          headers:
            Access-Control-Allow-Origin:
              type: string
            Access-Control-Allow-Methods:
              type: string
            Access-Control-Allow-Headers:
              type: string